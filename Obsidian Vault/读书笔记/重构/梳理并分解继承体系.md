---
tags:
  - reference
aliases:
  - Tease Apart InHeritance
refactor_type: 大型重构
---
> [!summary] 概要
> 某个继承体系同时承担两项责任。建立两个继承体系，并通过委托关系让其中一个可以调用另一个。

> [!summary] 动机
> 混乱的继承体系是一个严重的问题，因为它会导致重复代码，它还会使修改变得困难，因为特定问题的解决策略被分散到了整个继承体系。最终你的代码会非常难以理解。

> [!summary] 做法
> 1. 首先识别出继承体系所承担的不同责任，然后建立一个二维表格，并以坐标轴标示出不同的人物。
> 2. 判断哪一项责任更重要些，并将其留在当前的继承体系中。并将另一项责任转移到另一继承体系中。
> 3. 使用[[提炼类|Extract Class]]将当前超类中提炼出一个新类，用以表示新的责任，并在当前超类新增一个新类的实例变量。
> 4. 对于原继承体系中的每个子类，一一对应的创建一个新类的子类。并在原继承体系的子类中实例化对应的新类子类。
> 5. 使用[[搬移函数|Move Method]]将原子类中的行为搬运到新子类中。
> 6. 当原子类中没有任何代码时，将其去除。
> 7. 重复上述手法处理每一个子类。观察新体系看看能否实施其他重构手法，比如[[字段上移|Pull Up Field]]，[[函数上移|Pull Up Method]]。

> [!example] 范例
> ![[梳理并分解继承体系 2024-01-23 18.07.28.excalidraw]]