---
tags:
  - reference
aliases:
  - Change Bidirectional Association to Unidirectional
refactor_type: 重新组织数据
---
> [!summary] 概要
> 两个类之间存在双向关联，但其中一个类如今不再需要另一个类的特性。

> [!summary] 动机
> 双向关联虽然很有用，但在管理上会增加很多复杂度，导致僵尸对象，并使两个类产生了强耦合。所以只在真正需要双向关联时使用它，否则就请去除一条不必要的关联。

> [!summary] 做法
> 1. 找出保存着你想去除的字段引用，检查所有调用点，判断是否可以进行去除。
> 2. 如果客户使用了取值函数，首先用[[自封装字段|Self Encapsulate Field]]将待移除字段封装起来，然后用[[替换算法|Substitute Algorithm]]对付取值函数。
> 3. 如果没有使用取值函数，那就直接修改待移除字段的引用点，用其他途径获得该字段保存的对象。
> 4. 如果已经没有任何函数使用该字段，移除该字段的更新逻辑，然后删除该字段。
> 5. 测试。

> [!example] 范例
> ![[将双向关联改为单向关联 2024-01-11 19.35.27.excalidraw]]