---
tags:
  - reference
aliases:
  - Replace Method with Method Object
---
> [!summary] 概要
> 你有一个大型函数，其中对局部变量的存在让你无法用[[提炼函数|Extract Method]]来进行分解。可以将这个函数放进一个单独对象内，如此依赖局部变量就成了新对象的字段，然后你可以重新进行[[提炼函数|Extract Method]]。

> [!summary] 动机
> 如果一个函数局部变量泛滥成灾，非常难以分解，此时可以使用此方法。

> [!summary] 做法
> 1. 建立一个新类并根据原对象里待移动函数的用途为其命名。
> 2. 在新类中建立一个只读字段来引用原对象。
> 3. 在新类中创建一个构造函数，以原对象和待移动函数的参数作为构造参数。
> 4. 在新类中创建一个`Compute()`方法。
> 5. 将待移动函数的代码复制到`Compute()`中，修正函数体，将局部变量改为对字段的使用。
> 6. 将被移动的函数里的语句改为创建新对象并调用`Compute()` 方法。
> 7. 测试。

> [!example] 范例
> ![[以函数对象取代函数 2023-12-21 19.20.20.excalidraw]]
