---
tags:
  - reference
aliases:
  - Separate Query from Modifier
---
> [!summary] 概要
> 某个函数既返回对象的状态，又修改对象的状态。此时你应该将其拆分为两个函数，一个只查询不修改，一个只修改不查询。

> [!summary] 动机
> 当一个函数没有任何看的见的副作用的时候，你可以随意调用它而无需担心对系统产生任何影响。所以有一个好的规则就是：
> > [!quote]
> > 任何有返回值的函数，都不应该有看得到的副作用。

> [!summary] 做法
> 1. 新建一个查询函数，令他返回的值与原函数相同。
> 2. 修改原函数，令其调用查询函数。
> 3. 测试。
> 4. 将调用原函数的地方改为调用查询函数，然后在改动处的前一行加上对原函数的调用。每替换一个测试一次。
> 5. 将原函数改为无返回值的函数。

> [!example] 范例
> ![[将查询函数和修改函数分离 2023-12-14 21.06.25.excalidraw]]