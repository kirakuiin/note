---
tags:
  - reference
---
矩阵就是一个矩形的网格，其中的行与列排布于其中。正如向量是标量构成的数组一样，也可以将矩阵理解为向量构成的数组。

如果一个矩阵有$r$行，$c$列，我们就称之为$r \times c$矩阵，使用记号$m_{ij}$来引用第$i$行第$j$列的元素。

如下是一个$4 \times 3$矩阵$\textbf{M}$：
$$
\left[
\begin{matrix}
m_{11} &m_{12} &m_{13} \\
m_{21} &m_{22} &m_{23} \\
m_{31} &m_{32} &m_{33} \\
m_{41} &m_{42} &m_{43} \\
\end{matrix}
\right]
$$

---

# 方阵

所谓的方阵是指行和列相等的矩阵，在图形学中方阵是非常重要的，会涉及到$2 \times 2$，$3 \times 3$，$4 \times 4$矩阵。

如果一个方阵的**对角线元素**[^1]不为0，**非对角线元素**均为0，那么称之为对角矩阵。

$$
\left[
\begin{matrix}
m_{11} &0 &0 \\
0 &m_{22} &0 \\
0 &0 &m_{33} \\
\end{matrix}
\right]
$$

如果对角线上元素都为$1$，那么称之为**单位矩阵**，记作$I$。类似于标量里的$1$。单位矩阵也拥有乘法不变性的性质。

# 作为矩阵的向量

当矩阵的某一维度为$1$时，矩阵退化为一个向量。如果只有一行，那么叫做行向量，如果只有一列，那么叫做列向量。

$$
\left[
\begin{matrix}
m_{11} &m_{12} &m_{13} \\
\end{matrix}
\right]
\left[
\begin{matrix}
m_{11} \\m_{21} \\m_{31}
\end{matrix}
\right]
$$
当它们作为向量时，本质上是相通的。但当它们同矩阵运算时，必须弄清我们的向量是行向量还是列向量。

# 矩阵的转置

如果矩阵为$\textbf{M}$，则矩阵的转置为$\textbf{M}^T$，其含义为将原矩阵的行列互换，换句话说，对于矩阵的每个元素：$m^T_{ij} = m_{ji}$。

$$
\begin{align}
\left[
\begin{matrix}
a &b &c &d \\
e &f &g &h \\
i &j &k &l
\end{matrix}
\right]^{T}=
\left[
\begin{matrix}
a &e &i \\
b &f &j \\
c &g &k \\
d &h &l
\end{matrix}
\right]
\end{align}
$$

根据转置的规则，可以推导出如下规律：
- 行向量的转置为列向量，反之亦然。
- 对角矩阵的转置等于自身。
- 矩阵的转置的转置等于自身，$(\textbf{M}^{T})^{T} = \textbf{M}$。

# 矩阵乘以标量

结果为矩阵内的每个元素乘以标量所构成的矩阵。

$$
k\textbf{M} = k\left[\begin{matrix}m_{11} & m_{12} \\ m_{21} &m_{22} \end{matrix}\right] = \left[\begin{matrix}km_{11} &km_{12} \\ km_{21} &km_{22} \end{matrix}\right]
$$

# 矩阵相乘

矩阵的相乘必须满足一定条件，即第一个矩阵的列数必须和第二个矩阵的行数相等，乘积的行数等于第一个矩阵的行数，乘积的列数等于第二个矩阵的列数。

![[matrix_multiplication_result_size_rules.png]]

乘积中的每个元素可以根据$c_{ij} = \sum\limits_{k=1}^na_{ik}b_{kj}$进行计算。用文字来表达就是结果的第$i$行第$j$列等于$\textbf{A}$的第$i$行点乘$\textbf{B}$的第$j$列。

![[matrix_mult_example_row_column_1.png]]

可以展开为以下形式来辅助计算：

![[matrix_mult_example_row_column_2.png]]

> [!note] 矩阵乘法性质
> - 矩阵和方阵相乘后大小不会发生变化。
> - 矩阵乘法不满足交换律，$\textbf{A}\textbf{B} \ne \textbf{B}\textbf{A}$。
> - 矩阵乘法满足结合律，$(\textbf{A}\textbf{B})\textbf{C} = \textbf{A}(\textbf{B}\textbf{C})$。
> - 矩阵乘法同标量乘法也是可结合的，$(k\textbf{A})\textbf{B} = k(\textbf{A}\textbf{B}) = \textbf{A}(k\textbf{B})$。
> - 积的转置等于逆序转置的积，$(\textbf{M}_1\textbf{M}_2\cdots\textbf{M}_{n-1}\textbf{M}_n)^T = \textbf{M}_n^T\textbf{M}_{n-1}^T\cdots\textbf{M}_2^T\textbf{M}_1^T$
# 矩阵乘向量

根据矩阵的定义，向量可以理解为某一维度为$1$的矩阵，根据矩阵乘法的规则，行向量和列向量会位于乘式的两边。

$$
\begin{align}
[\begin{matrix}x &y &z\end{matrix}]
\left[\begin{matrix}
m_{11} &m_{12} &m{13} \\
m_{21} &m_{22} &m{23} \\
m_{31} &m_{32} &m{33}
\end{matrix}\right] &=
\left[\begin{matrix}
xm_{11}+ym_{21}+zm_{31} \\
xm_{12}+ym_{22}+zm_{32} \\
xm_{13}+ym_{23}+zm_{33}
\end{matrix}\right]^T \\
\left[\begin{matrix}
m_{11} &m_{12} &m{13} \\
m_{21} &m_{22} &m{23} \\
m_{31} &m_{32} &m{33}
\end{matrix}\right] 
\left[\begin{matrix}x \\y \\z\end{matrix}\right]
&=
\left[\begin{matrix}
xm_{11}+ym_{12}+zm_{13} \\
xm_{21}+ym_{22}+zm_{23} \\
xm_{31}+ym_{32}+zm_{33}
\end{matrix}\right] \\
\end{align}
$$

尽管上述等式中向量和矩阵都是相等的，但左乘和右乘会导致不同的结果，根据矩阵乘法转置的性质可知：

$$
\textbf{v}\textbf{A}\textbf{B}\textbf{C} 
= ((\textbf{v}\textbf{A}\textbf{B}\textbf{C})^T)^T
= (\textbf{C}^T\textbf{B}^T\textbf{A}^T\textbf{v}^T)^T
$$

另外根据等式可以推断出如下结论：
- 每个元素都是向量和矩阵中列或行的点积。
- 矩阵中的每个元素都代表了对应向量分量在结果向量分量中的权重。
- 乘法对于向量加法是可分配的，即$(\textbf{v} + \textbf{w})\textbf{M} = \textbf{v}\textbf{M} + \textbf{w}\textbf{M}$
- 最重要的一点，**可以将乘法结果看作为矩阵行或者列的线性组合，而向量则代表着线性组合的系数**。
	- 对行向量，结果是矩阵每一行的线性组合。
	- 对列向量，结果是矩阵每一列的线性组合。

> [!summary] 行向量还是列向量？
> 行向量乘法的优点在于更加符合人类的阅读顺序，从左到右；列向量乘法的优点在于展开空间占用小。

# 矩阵的几何角度

总的来说，一个方阵可以描述任意一个[[线性变换]]，我们根据[[多坐标空间#基向量|基向量]]可知，任何一个向量可以用基向量的线性组合来表达：

1.  首先假设向量$\textbf{v}$(*行向量*)位于标准正交基坐标系内：
$$
\textbf{v} = v_x\textbf{i} + v_y\textbf{j} + v_z\textbf{k}
$$
2. 用$\textbf{v}$乘以变换矩阵$\textbf{M}$：
$$
\begin{align}
\textbf{v}\textbf{M} &= (v_x\textbf{i} + v_y\textbf{j} + v_z\textbf{k})\textbf{M} \\
&= (v_x\textbf{i})\textbf{M} + (v_y\textbf{j})\textbf{M} + (v_z\textbf{k})\textbf{M} \\
&= v_x(\textbf{i}\textbf{M}) + v_y(\textbf{j}\textbf{M}) + v_z(\textbf{k}\textbf{M} )\\
&= \textbf{v}_x[\begin{array}&m_{11} &m_{12} & m_{13}\end{array}] + \textbf{v}_z[\begin{array}&m_{21} &m_{22} & m_{23}\end{array}] + \textbf{v}_z[\begin{array}&m_{31} &m_{32} & m_{33}\end{array}]
\end{align}
$$
3. 根据观察可以发现，结果刚好为矩阵$\textbf{M}$每一行的线性组合：
$$
\textbf{v}\textbf{M}
= \left[\begin{matrix}v_x &v_y &v_z\end{matrix}\right]
\left[\begin{matrix}-p- \\-q- \\-r-\end{matrix}\right] = 
v_x\textbf{p} + v_y\textbf{q} + v_z\textbf{r}
$$

> [!summary] 结论
> 一个坐标空间的基向量构成了变换矩阵的每一行，换言之，一个矩阵表达了一个坐标空间。要将一个向量由源空间转到目标空间，就用向量乘以源空间的基向量(用目标空间坐标表示)矩阵。
> ![[2d_matrix_box.png]]
> 在这个视角下，我们还可以反过来通过坐标空间的形状来构建对应的矩阵。

[^1]: 对角线元素是指行列下标相等的元素。

