---
tags:
  - reference
design_pattern: Prototype
category: 创建型模式
---
> [!summary] 意图
> 用原型实例指定创建对象的种类，并且通过拷贝这些原型新的对象。

> [!summary] 适用性
> 在以下情况下可以使用：
> - 当要实例化的类是在运行时刻时，例如通过动态装载。
> - 为了避免创建一个与产品类层次平行的工厂类层次时。
> - 当一个类的实例只能有几个不同状态组合中的一种时。建立相应数目原型并克隆它可能比用合适的状态手工实例化更方便一些。

> [!summary] 结构图
> ![[原型模式 2023-11-09 15.54.43.excalidraw]]
> 客户通过请求一个原型，通过原型不断克隆来创建新的实例。

> [!summary] 效果
> 1. 可以在运行时刻增加和删除产品，通过注册原型实例可以灵活配置。
> 2. 通过调整原型的值和结构可以创建出表现不同的新原型，减少了子类的增长速度。
> 3. 每一个原型都必须要实现`Clone()`方法，而且有一些对象拷贝起来可能比较困难。

> [!tips] 实现细节
> - 通过一个原型管理器来管理全部的原型。这个管理器是一个字典结构，它返回一个对应关键字的原型。
> - 正确的实现克隆操作。这是最困难的一步，特别是对象结构包含循环引用时。
> - 提供初始化操作来重新设置原型的状态。

> [!note] 相关模式
> - [[抽象工厂模式]]可以同原型一起使用，比如说抽象工厂可以存储一个产品原型来返回产品对象。
> - 大量使用[[组合模式]]和[[装饰模式]]的地方也可以从原型中获益。
