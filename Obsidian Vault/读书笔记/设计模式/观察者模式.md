---
tags:
  - reference
design_pattern: Observer
category: 行为型模式
---
> [!summary] 意图
> 定义对象间一种一对多的依赖关系，当一个对象的状态发生改变时，所有依赖它的对象都得到通知并被自动更新。

> [!summary] 适用性
> 在以下情况下可以使用：
> - 当一个抽象模型有两个方面，一个依赖于另一个。将两者封装于独立的对象里使它们可以各自独立的改变和复用。
> - 当一个对象改变时需要同时改变其他对象，而不知道有多少具体的对象需要改变。
> - 当一个对象必须通知其他对象，但又不能假定其他对象是谁。

> [!summary] 结构图
> ![[观察者模式 2023-11-24 18.49.50.excalidraw]]
> 当`ConcreteSubject`发生任何导致观察者和本身状态不一致的改变时，它将通知各个观察者。

> [!summary] 效果
> 1. 目标和观察者之间不再紧密耦合。
> 2. 支持广播通信。
> 3. 根据实现，广播的顺序可能会导致异常，难以排查。

> [!tips] 实现细节
> - 如何创建目标到观察者之间的映射。
> - 如果观察者以失效，如何处理悬挂引用的问题。
> - 在发出通知前，确保所有目标的状态是一致的。

> [!note] 相关模式
> - 将管理观察者的职责交给[[中介者模式]]里的中介者，可以彻底让`Subject`和`Observer`解耦。这个就是[[订阅-发布模式]]。
> - 使用[[读书笔记/设计模式/单例模式|单例模式]]来实现中介者，确保它是全局唯一的。
