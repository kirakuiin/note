---
tags:
  - reference
design_pattern: Visitor
category: 行为型模式
---
> [!summary] 意图
> 表示一个作用于某对象结构中各元素的操作。

> [!summary] 适用性
> 在以下情况下可以使用：
> - 一个对象结构包含很多类对象，它们有不同的接口，而你想对这些对象实施一些依赖于具体类的操作。
> - 需要对一个对象结构中的对象进行很多不同的并且不相关的操作，而你想避免这些操作污染这些对象的类。
> - 定义对象结构的类很少改变，但经常需要在此结构上定义新的操作。

> [!summary] 结构图
> ![[访问者模式 2023-11-26 13.20.38.excalidraw]]
> 一个使用访问者模式的`Client`必须创建一个`Vistor`对象，然后用它遍历`ObjectStructure`来访问内部的每一个元素。
> ![[访问者模式 2023-11-26 13.34.27.excalidraw]]

> [!summary] 效果
> 1. 访问者模式使得易于增加新的操作。
> 2. 访问者集中相关操作，分离了无关操作。
> 3. 很难扩充新的`ConcreteElement`，影响很大。
> 4. 破坏了类的封装性。

> [!tips] 实现细节
> - 谁来执行遍历操作？一般都在`ObjectStruct`内或者使用迭代器来执行。

> [!note] 相关模式
> - [[组合模式]]可以利用此模式对内部结构进行操作。
> - [[解释器模式]]可以利用此模式抽象出公共的解释性操作。
