---
tags:
  - reference
design_pattern: Flyweight
category: 结构型模式
---
> [!summary] 意图
> 运用共享技术有效支持大量细粒度对象。

> [!summary] 适用性
> 在以下情况下可以使用：
> - 一个应用程序使用了大量的对象造成了很多存储开销。
> - 对象的大多数状态可以变为外部状态。
> - 如果删除了**外部状态[^1]** ，可以用较少的共享对象取代很多组对象。

> [!summary] 结构图
> ![[享元模式 2023-11-20 14.00.17.excalidraw]]
> 用户通过工厂对象获得享元。

> [!summary] 效果
> 1. 因为共享有效的节省了总实例的数目，节省了资源和空间。
> 2. 节省的程度由内部状态的数目和**外部状态[^1]** 的实现方式来共同决定的。如果外部状态是计算出来的，自然会更节省空间。

> [!tips] 实现细节
> - 要有办法快速清除对象的外部状态。
> - 要对享元池内的享元对象进行合理的管理，防止出现内存泄漏等情况。

> [!note] 相关模式
> - 享元模式可以用来支持[[组合模式]]的共享叶结点。
> - [[读书笔记/设计模式/状态模式|状态模式]]和[[策略模式]]最好用享元来实现。

[^1]: 外部状态是指对象的根本特征，不同对象之间是不同的。与其相对的是内部状态，在不同对象之间的内部状态是一样的。