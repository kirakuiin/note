---
tags:
  - interview
---

# 网络

## 网络栈

由低到高分别为：
- 接口层：负责实际的物理数据传输；
- 网络层：负责路由，转发数据包，IP协议位于这一层；
- 传输层：负责端到端的程序通信，TCP/UDP位于这一层；
- 应用层：用来处理特定的应用，比如FTP，SMTP等等；

## TCP/UDP

*TCP*名为传输控制协议，是一个面向连接的，可靠的流式传输协议，发送的是不间断的数据流。它的主要特点有：
- 通过三次握手建立连接，可以理解为A通知B，B确认并反问A，A确认的过程；
- 每个数据包具有序列号，并且收到后会发确认收到消息；
- 超时会重新发送数据包；
- 拥有拥塞控制功能，防止网络拥塞发生；
- 拥有窗口控制功能，可以根据网络水平调整发送速度；
- 使用四次挥手来断开连接，实际上是握手的反向过程，即A通知B，B确认，B通知A，A确认；

---

*UDP*名为用户数据报，是一种无连接，不可靠的通信服务，它的主要特点有：
- 不对数据排序，报文内部也没有顺序信息；
- 不会确认数据是否收到；
- 传输速度比TCP快，开销也少；

## IP数据包分片

分片指的是在以太网上每个数据包的大小最多为1500字节，如果大于这个数值就会被拆分为多个数据包。多个数据包保留基本相同的包头，并携带不同部分的包体数据。

# 操作系统

## 虚拟内存是什么

虚拟内存指的是操作系统给应用程序提供了一大段虚拟的连续的内存空间，然而实际上这段空间实际上并不连续。它有以下的作用：
- 便于开发大型程序；
- 切割进程空间提高安全性；
- 可以使多个内存共享一个运行时库；

![[基础 2024-08-17 16.12.03.excalidraw]]

虚拟内存内部分为内核空间和用户空间，内核空间是操作系统专用的，只能通过系统调用来使用，一般占据高字节位置，并且这个空间被所有进程共享。用户空间从高到低则是由：
- 栈。
- 共享区，内存映射，动态库所在地。
- 堆
- bss段
- data段
- text段
- 保留区

## 线程中共享的资源有哪些

共享的有：
- 堆
- 数据段
- 文件资源
不共享的有：
- 进程ID
- 寄存器的值
- 栈
- 错误码

# 面向对象

## private的真正含义

private并不是仅限同一个对象才能访问，而是限定在同一个类型。

```csharp
class A
{
	private int _a = 0;

	public int F(A rhs)
	{
		// 尽管不是一个对象，但是因为位于一个类型内，所以可以这样使用
		return rhs._a;
	}
}
```

# 图形学

## 渲染管线流程简述

1. 准备数据，简单剔除不会被渲染的对象。
2. 设置渲染状态，比如着色器，顶点，材质等等。
3. 通知GPU进行渲染。
4. 顶点着色器阶段，将模型坐标转化为裁剪空间坐标，纹理坐标生成，蒙皮也在此步骤。
5. 裁剪不在裁剪空间内的模型，剔除背面。
6. 齐次除法，将空间变换到标准设备空间。
7. 光栅化，将表面映射到每个像素上。
8. 像素着色器阶段，输出像素的颜色和透明度。
9. 如果颜色是不透明的且深度小于缓冲中的深度则直接写入；如果颜色是透明的且深度小于缓冲则根据透明度混合后写入缓冲。

## 片段和像素的区别

片段是包含渲染像素所需要的全部数据的结构，比如位置，纹理坐标，深度等等。

## 光栅化

光栅化是指把三角形图元映射到像素上的过程，是通过对各个顶点插值完成的。

## gamma校正

因为人眼对光线的感知不是线性的，通过gamma校正，可以将原始光线转换为对人眼更加平滑的光线。其公式为：
$$
after = before^{\frac{1}{2.2}}
$$

这样暗部会变的更加明亮，亮部会变的更加阴暗。

## HDR是什么

也被成为高动态范围图像，相比普通的图像，可以提供更多的图像的细节。说白了就是让图片尽可能同时显示最亮和最暗的部分，让亮的地方更亮，暗的地方更暗。

## Mipmap是什么

Mipmap，也叫多级渐远纹理，是指为一个纹理生成多个大小逐级递减的纹理，其中每一级的宽高都是上一级一半，每一级的纹素都由上一级的四个像素采样插值而来。

这个主要是为了解决当纹理距离相机较远时，纹理会变得很小，此时有两种采样策略：
- 临近过滤：考虑离中心点最近的纹理作为颜色。
- 线性过滤：考虑采样像素周围的四个像素按距离混合。

当距离很远时，可能单个像素就要渲染图片20x20的内容，而采样最多只会考虑2x2，这会导致严重的失真。而通过Mipmap可以选择合适等级的纹理，而每一级都是经过平均的采样的，所以不会丢失太多细节。

它的优点在于：
- 渲染质量高。
- 性能好。
缺点是：
- 占用更多的显存，根据等比数列的无穷级数和，其极限收敛于$\frac{4}{3}$，所以会最多额外占用$\frac{1}{3}$的内存空间。
	$$
	\lim_{n\rightarrow\infty}\sum_{i=0}^{n}\frac{1}{4^n} = 
	\frac{1-\frac{1}{4^n}}{1-\frac{1}{4}} =
	\frac{4}{3}
	$$

## 抗锯齿有哪些策略

首先要明白什么是锯齿，锯齿就是采样的失真，丢失了原始数据的连续性导致图像出现锯齿。为了降低锯齿感的做法叫做抗锯齿。

以下方案假设渲染分辨率为800x600。

- SSAA：超采样技术，最简单粗暴，也是效果最好的。比如说4xSSAA就是用4倍的采样点，先将缓冲渲染到3200x2400的buffer中，然后重新混合到800x600的分辨率中。这个方案的缺陷非常明显，buffer空间，光栅化，着色的工作都是原来的4倍，性能很差。
- MSAA：多重采样技术，对于4xMSAA，对同一个采样点也是用了4倍的子采样点，这一点同SSAA类似，但是这些采样点内部包含**遮罩和覆盖信息**[^1]，对于那些通过这两项测试的子采样点来说。会将颜色按照算法混合到采样点中。虽然深度缓冲和颜色缓冲占用4倍空间，但着色只会对通过测试的进行，所以性能会好很多。

# 其他

## 浅拷贝和深拷贝

浅拷贝只复制对象的值，而深拷贝不止要复制对象的值，也要负责拷贝对象内部引用，指向的对象。

[^1]: 遮罩类似于深度，覆盖意味着这个采样点是否被三角形覆盖到。