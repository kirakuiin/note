---
tags:
  - reference
---
# 架构

架构是开发人员对开发所设立的一套规则和实践，一个好的架构应该满足以下特征：

- 组织：当新增一个功能时知道在哪里放置代码，资产。
- 开发：知道如何实现一个新的功能。
- 测试：可以测试新功能。
- 结构：有办法得到新功能所需要的依赖。
- 一致性：保持代码的统一格式。
- 灵活性：当重构代码时对整个架构的影响要尽可能小。

如果梳理一下架构，如果清除所有的弱耦合后，得到一个有向无环图，那么说明这是一个好的架构。如图所示。

![[游戏的体系架构 2024-09-01 17.11.00.excalidraw]]

## 架构的抽象层

一般典型的游戏应用程序都可以分为三个层次，从上到下它们的抽象程度越来越低：

- 视觉层：游戏引擎提供的组件，比如`MonoBehaviour`，`Node`等，这部分层级直接处理视觉效果。
- 逻辑层：又可以分为两种类型。
	- 视觉逻辑层：包含状态机，行为树，各种各样用来控制和驱动视觉表现的逻辑。
	- 纯粹逻辑层：不会单单影响一个具体的视觉对象，而是横跨多个范围，处理一些通用的逻辑。
- 数据层：这部分提供一些底层的功能，比如文件读写，网络读写等等。

并且属于上面层次的对象只能与直接在它们下方的层**强耦合**[^1]

# 文件组织结构

有两种主流的组织方式：
## 将文件按照类型分类

- 图片，音频，文字，纹理都放到`Assets`目录下。
- 脚本放到`Scripts`目录下。
- 场景放到`Scenes`目录下。
- 预制体放到`Prefabs`目录下。

这种组织的优点在于：
- 有效的减少重复。
- 相同类型的位于一起，便于管理。
- 便于查找。
缺点在于：
- 维护复杂，资源变多后难以定位。
- 灵活性差。

## 将文件按照功能分类

用于实现同一个功能的所有文件都放到一个目录下，比如一个名为`Player`的目录，内部可能有以下结构：
```
/Player
	/Player.cs
	/Player.tscn
	/Audio
		/one.mp3
		/two.ogg
	/Sprite
		/arm.png
	/Weapon
		/Weapon.cs
```

如果有一些通用的文件，会被多个领域使用，那么可以创建一个`common`目录专门存放这种通用的文件。

这种组织方式的优点在于：
- 高效率，一个功能所需要的资源是自包含的，非常容易扩展和定位。
- 灵活性高，每个功能模块都是独立的，修改时不会影响其他模块。
缺点在于：
- 可能又重复，部分资源可能会被重复创建。

## 总结

如果是一位独立的游戏开发者，更建议使用第二套方案，也就是[[游戏的体系架构#将文件按照功能分类]]。

[^1]: 强耦合指的是两个类型之间有直接的关系，弱耦合指的是两个类型通过第三方对象有间接的关系。